(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},6:function(e,t){},6821:function(e,t,s){"use strict";(function(e){s("ace4"),s("84c3");var a=s("cf57");const i=s("59da");var n=s("6f78");t["a"]={data(){return{pinPad:!1,confirmDelete:!1,waitUntil:!1,errorPopup:!1,pin:[],pinTemp:"",port:{},writableStreamClosed:{},reader:null,writer:null,readableStreamClosed:{},breakBool:!1,readMessage:[],yesHW:0,firstPin:0}},name:"PageIndex",computed:{pinAmount:function(){self=this,self.pinTemp="";for(var e=0;e<self.pin.length;e++)self.pinTemp=self.pinTemp+"*";return self.pinTemp}},methods:{async connectDevice(){self=this;let e=!1;e||(self.port=await navigator.serial.requestPort()),self.port?(self.pin=[],e=!0,await this.callPin()):e=!1},async readPort(){self=this;try{await self.port.open({baudRate:115200})}catch(e){try{await self.reader.releaseLock(),self.reader=void 0,await self.port.close(),await self.port.open({baudRate:115200})}catch(e){}}try{self.reader=self.port.readable.getReader();const{value:e,done:t}=await self.reader.read();e&&(self.readMessage=e),await self.reader.releaseLock(),self.reader=void 0}catch(e){}if(self.port)try{await self.port.close()}catch(e){}},async writeData(e){self=this;const t=new TextEncoder;try{await self.port.open({baudRate:115200})}catch(s){try{await self.writer.releaseLock(),self.writer=void 0,await self.port.close(),await self.port.open({baudRate:115200})}catch(s){}}try{self.writer=await self.port.writable.getWriter(),await self.writer.write(t.encode(e)),await self.writer.releaseLock(),self.writer=void 0}catch(s){}if(self.port)try{await self.port.close()}catch(s){}},async hardReset(){self=this,self.firstPin=1,self.confirmDelete=!1,self.waitUntil=!0,self.$q.notify({spinner:a["a"],message:"Wiping EVERYTHING...",timeout:6e3}),await self.writeData("HARDRESET");var e=setInterval((async function(){await self.readPort();var t=self.readMessage;const s=await self.ab2str(t);console.log(s);var a=s.split(",");console.log(a),1==a.includes("PINSTART")&&(self.yesHW=1,self.waitUntil=!1,self.breakBool=!0,self.$q.notify({message:"Enter an 8 digit pin",caption:"Use the Bowser for a pin reference!",color:"primary"}),clearInterval(e))}),2e3);self.breakBool=!1},async softResetReload(){this.writeData("SOFTRESET"),location.reload()},async softReset(){this.writeData("SOFTRESET")},async callPin(){self=this,self.writeData("CONNECT");var e=0;self.$q.notify({spinner:a["a"],message:"connecting...",timeout:2e3});var t=setInterval((async function(){await self.readPort();var s=self.readMessage;const a=await self.ab2str(s);var i=await a.split(",");console.log(i),1==i.includes("NOHWW")&&(self.yesHW=0,self.pinPad=!0,self.$q.notify({message:"No wallet found on device",caption:"HARD RESET, or RESTORE"}),clearInterval(t)),1==i.includes("YESHWW")&&(self.yesHW=1,self.pinPad=!0,await self.writeData("HANDSHAKE"),self.$q.notify({message:"Wallet found!",caption:"Please enter pin",color:"primary"}),clearInterval(t)),e>3&&(self.$q.notify({message:"ERROR: Could not connect",caption:"Is the Bowser powered on?",color:"negative"}),clearInterval(t)),e+=1}),2e3)},async sendPin(){self=this,sessionStorage.setItem("%P1",""),sessionStorage.setItem("%P2",""),sessionStorage.setItem("%P3",""),sessionStorage.setItem("zpub",""),sessionStorage.setItem("ADR",""),sessionStorage.setItem("VADDR",""),await self.sendProcessing(),setTimeout((async function(){console.log(self.pin),console.log(self.pin.join().replaceAll(",","")),await self.writeData("PIN"+self.pin.join().replaceAll(",",""))}),2e3);var e=setInterval((async function(){await self.readPort();var t=self.readMessage;const s=await self.ab2str(t);var a=s.split(",");console.log(a);for(var i=0;i<a.length;i++)"%P1"==a[i].substring(0,3)&&sessionStorage.getItem("%P1").length<a[i].length-3?(console.log(a[i].length-3),console.log(sessionStorage.getItem("%P1").length),console.log(sessionStorage.getItem("%P1")),sessionStorage.setItem("%P1",a[i].substring(3,a[i].length))):"%P2"==a[i].substring(0,3)&&sessionStorage.getItem("%P2").length<a[i].length-3?sessionStorage.setItem("%P2",a[i].substring(3,a[i].length)):"%P3"==a[i].substring(0,3)&&sessionStorage.getItem("%P3").length<a[i].length-3?sessionStorage.setItem("%P3",a[i].substring(3,a[i].length)):"ADR"==a[i].substring(0,3)&&sessionStorage.getItem("ADR").length<a[i].length-3&&sessionStorage.setItem("ADR",a[i].substring(3,a[i].length));if(1==a.includes("PINPASS")){var n=sessionStorage.getItem("%P1"),l=sessionStorage.getItem("%P2"),r=sessionStorage.getItem("%P3");sessionStorage.setItem("zpub",n+l+r);var o=await self.getAddress(0);console.log("the addressString is"+o),sessionStorage.setItem("VADDR",o),self.pinPad=!1,self.$router.push("wallet"),clearInterval(e)}1==a.includes("PINFAILL")&&(self.$q.notify({message:"ERROR: Pin failed",caption:"Use the Bowser wallet as a reference",color:"negative"}),self.pin=[],clearInterval(e))}),2e3)},async sendProcessing(){await this.writeData("PROCESS")},async ab2str(e){return String.fromCharCode.apply(null,new Uint16Array(e))},getAddress(t){function s(t){var s=n.decode(t);return s=s.slice(4),s=e.concat([e.from("0488b21e","hex"),s]),n.encode(s)}var a=s(sessionStorage.getItem("zpub")),l=i.bip32.fromBase58(a);console.log(l.derive(0).derive(t).publicKey);const{address:r}=i.payments.p2wpkh({pubkey:i.bip32.fromBase58(a).derive(0).derive(1).publicKey});return console.log(r),r}},created(){}}}).call(this,s("1c35").Buffer)},7:function(e,t){},"8b24":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{staticClass:"flex flex-center"},[s("div",{staticClass:"column"},[s("div",{staticClass:"col-11"},[s("center",[s("q-btn",{attrs:{size:"35px",rounded:"",color:"primary",icon:"link"},on:{click:function(t){return e.connectDevice()}}},[e._v("\n          Connect Device")])],1)],1),s("div",{staticClass:"col-1"},[s("center",[s("q-card",{staticClass:"q-mt-md"},[e._v("\n          Bowser Wallet is free and open-source, runs 100% in "),s("br"),e._v("\n          your browser, can be used locally and can be used offline!"),s("br"),s("a",{attrs:{href:"https://github.com/arcbtc/little-bowser"}},[e._v("https://github.com/arcbtc/little-bowser")])])],1)],1)]),s("q-dialog",{model:{value:e.confirmDelete,callback:function(t){e.confirmDelete=t},expression:"confirmDelete"}},[s("q-card",[s("q-card-section",{staticClass:"row q-mx-auto q-pt-xl"},[e._v("\n        Are you sure you want to delete EVERYTHING and hard reset this device?\n      ")]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{staticClass:"q-ml-lg q-pl-md q-pr-md",staticStyle:{color:"red"},attrs:{outline:"",dense:"",label:"I understand"},on:{click:function(t){return e.hardReset()}}})],1)],1)],1),s("q-dialog",{model:{value:e.errorPopup,callback:function(t){e.errorPopup=t},expression:"errorPopup"}},[s("q-card",[s("q-card-section",{staticClass:"row q-mx-auto q-pt-xl"},[s("h3",[e._v("FAILED TO CONNECT, TRY AGAIN")]),s("q-icon",{staticClass:"text-primary",staticStyle:{"font-size":"15rem"},attrs:{name:"warning"}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:e.waitUntil,callback:function(t){e.waitUntil=t},expression:"waitUntil"}},[s("q-card",[s("q-card-section",{staticClass:"row q-mx-auto q-pt-xl"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-10"},[e._v("\n            Copy your backup words somewhere secure and private,\n            "),s("br"),e._v("then enter an 8 digit pin, using refernce bowser pinpad.\n          ")]),s("div",{staticClass:"col-2"},[s("img",{staticClass:"q-mx-auto ",staticStyle:{width:"70px"},attrs:{src:"https://i.imgur.com/rnPG6wd.gif"}})])])]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{staticStyle:{color:"goldenrod"},attrs:{outline:"",dense:"",label:"Cancel"},on:{click:function(t){return e.softResetReload()}}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:e.pinPad,callback:function(t){e.pinPad=t},expression:"pinPad"}},[s("q-card",[s("center",[e.pinAmount.length<1?s("p",{staticClass:"q-pt-xl",staticStyle:{"font-size":"50px","line-height":"60%"},attrs:{dense:"",value:"pin.length()"}},[e._v("\n          Enter pin\n          "),s("br"),s("small",{staticStyle:{"font-size":"10px","padding-left":"150px"}},[e._v("or\n            "),s("q-btn",{attrs:{flat:"",disabled:1==e.firstPin,dense:"",color:"primary",label:"hard reset"},on:{click:function(t){e.confirmDelete=!0}}}),e._v("/"),s("q-btn",{attrs:{flat:"",disabled:1==e.firstPin,dense:"",color:"primary",label:"restore"},on:{click:function(t){e.confirmDelete=!0}}})],1)]):s("p",{staticClass:"q-pt-xl",staticStyle:{"font-size":"50px"},attrs:{dense:"",value:"pin.length()"}},[e._v("\n          "+e._s(e.pinAmount)+"\n        ")])]),s("q-card-section",{staticClass:"row q-mx-auto q-pt-none",staticStyle:{width:"70%"}},[s("div",{staticClass:"row",staticStyle:{width:"100%"}},[s("div",{staticClass:"col"},[s("q-btn",{staticStyle:{width:"100%"},attrs:{disabled:0==e.yesHW,unelevated:"",outline:"",color:"primary",padding:"lg",size:"xl"},on:{click:function(t){return e.pin.push(1)}}},[e._v("*")])],1),s("div",{staticClass:"col"},[s("q-btn",{staticStyle:{width:"100%"},attrs:{disabled:0==e.yesHW,unelevated:"",padding:"lg",size:"xl",outline:"",color:"primary"},on:{click:function(t){return e.pin.push(2)}}},[e._v("*")])],1),s("div",{staticClass:"col"},[s("q-btn",{staticStyle:{width:"100%"},attrs:{disabled:0==e.yesHW,unelevated:"",size:"xl",outline:"",color:"primary",padding:"lg"},on:{click:function(t){return e.pin.push(3)}}},[e._v("*")])],1)]),s("div",{staticClass:"row",staticStyle:{width:"100%"}},[s("div",{staticClass:"col"},[s("q-btn",{staticStyle:{width:"100%"},attrs:{disabled:0==e.yesHW,unelevated:"",padding:"lg",size:"xl",outline:"",color:"primary"},on:{click:function(t){return e.pin.push(4)}}},[e._v("*")])],1),s("div",{staticClass:"col"},[s("q-btn",{staticStyle:{width:"100%"},attrs:{disabled:0==e.yesHW,unelevated:"",padding:"lg",size:"xl",outline:"",color:"primary"},on:{click:function(t){return e.pin.push(5)}}},[e._v("*")])],1),s("div",{staticClass:"col"},[s("q-btn",{staticStyle:{width:"100%"},attrs:{disabled:0==e.yesHW,unelevated:"",size:"xl",outline:"",color:"primary",padding:"lg"},on:{click:function(t){return e.pin.push(6)}}},[e._v("*")])],1)]),s("div",{staticClass:"row",staticStyle:{width:"100%"}},[s("div",{staticClass:"col"},[s("q-btn",{staticStyle:{width:"100%"},attrs:{disabled:0==e.yesHW,unelevated:"",padding:"lg",size:"xl",outline:"",color:"primary"},on:{click:function(t){return e.pin.push(7)}}},[e._v("*")])],1),s("div",{staticClass:"col"},[s("q-btn",{staticStyle:{width:"100%"},attrs:{disabled:0==e.yesHW,unelevated:"",padding:"lg",size:"xl",outline:"",color:"primary"},on:{click:function(t){return e.pin.push(8)}}},[e._v("*")])],1),s("div",{staticClass:"col"},[s("q-btn",{staticStyle:{width:"100%"},attrs:{disabled:0==e.yesHW,unelevated:"",size:"xl",outline:"",color:"primary",padding:"lg"},on:{click:function(t){return e.pin.push(9)}}},[e._v("*")])],1)])]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),8==e.pin.length?s("q-btn",{attrs:{flat:"",label:"Connect",color:"primary"},on:{click:function(t){return e.sendPin()}}}):s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",disabled:"",label:"Connect",color:"primary"}})],1)],1)],1)],1)},i=[],n=s("6821"),l=n["a"],r=s("2877"),o=s("9989"),c=s("9c40"),d=s("f09f"),p=s("24e8"),f=s("a370"),u=s("4b7e"),g=s("0016"),v=s("7f67"),m=s("eebe"),w=s.n(m),b=Object(r["a"])(l,a,i,!1,null,null,null);t["default"]=b.exports;w()(b,"components",{QPage:o["a"],QBtn:c["a"],QCard:d["a"],QDialog:p["a"],QCardSection:f["a"],QCardActions:u["a"],QIcon:g["a"]}),w()(b,"directives",{ClosePopup:v["a"]})}}]);