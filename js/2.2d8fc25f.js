(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"0de8":function(t,e,s){s("ddb0");const i=s("bc3a");let a="";async function o(t){if(!t)throw new Error("Address is missing!");const e=await i.get(`${a}/api/address/${t}/utxo`);if(200!==e.status)throw new Error(`Cannot fetch UTXOs for address ${t}`);return e.data}async function n(t=[]){let e=[];for(addr of t){const t=await o(addr);e=e.concat(t)}return e.forEach((t=>delete t.status)),e}function r(t){if(!t)throw new Error("Please provide the host value!");return a=t,{getUtxosForAddress:o,getUtxosForAddressList:n}}t.exports=r},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},"50b2":function(t,e,s){"use strict";(function(t){s("ddb0");const i=s("59da"),a=s("7042"),o=s("0de8")("mempool"),n=s("79ad")("mempool"),r=s("abf0")("mempool");e["a"]={data(){return{xPub:"",derivationRoot:"0",derivationStartIndex:0,derivationSize:10,network:"testnet",destinationAddress:"",sentAmount:0,changeAddress:"",fees:{},feeMode:"fastestFee",feeValue:"",tableData:[],utxoList:[],addressList:[],base64Psbt:"",columns:[{name:"address",required:!0,label:"Address",align:"left",field:t=>t.address,format:t=>`${t||""}`,sortable:!0},{name:"amount",align:"center",label:"Amount",field:"value",sortable:!0},{name:"vout",align:"center",label:"VOut",field:"vout",sortable:!0},{name:"txid",required:!1,label:"Transaction ID",align:"left",field:t=>t.txid,format:t=>`${t||""}`,sortable:!0}],pagination:{rowsPerPage:30},showEmptyAddresses:!1}},methods:{async findUtxos(){const t=this.showMesage("Searching UTXOs");this.utxoList=[],this.tableData=[];try{this.updateFees();const e=await this.fetchUtxoListForMasterPubKey(this.xPub),s=this.utxoListToTableData(e);this.utxoList=s.concat(),this.tableData=this.showEmptyAddresses?s:s.filter((t=>t.txid)),this.changeAddress=this.findChangeAddress()}catch(e){this.showError(e)}finally{t()}},async updateFees(){try{this.fees=await n.getRecommendedFees(),this.feeValue=this.fees[this.feeMode]}catch(t){this.showError(t)}},async buildPsbt(){const t=this.showMesage("Building PSBT");try{if(!this.destinationAddress)throw new Error("Destination address is missing");if(!this.changeAddress)throw new Error("Change address is missing");const e=this.utxoList.filter((t=>t.txid)),s=await this.enrichUtxoList(e),i={address:this.destinationAddress,value:+this.sentAmount},o=a(s,[i],this.feeValue);if(!o.inputs||!o.inputs.length)throw new Error("Cannot select coins using the provided UTXO set and coin selection algorithm!");const n=this.txDataToPsbt(o,this.changeAddress);this.base64Psbt=n.toBase64()}catch(e){this.showError(e)}finally{t()}},async enrichUtxoList(e){const s=[];for(const i of e){const e=await r.getTx(i.txid),a=e.vout[i.vout];s.push({txid:i.txid,vout:i.vout,value:i.value,witnessUtxo:{script:t.from(a.scriptpubkey,"hex"),value:i.value}})}return s},async fetchUtxoListForMasterPubKey(t){const e=t.toLowerCase().startsWith("zpub")?this.zpubToXpub(t):t,s=i.networks[this.network],a=i.bip32.fromBase58(e,s);this.addressList=this.deriveAddresses(a,{rootPath:this.derivationRoot,start:this.derivationStartIndex,size:this.derivationSize,network:s});const n=this.addressList.map((t=>o.getUtxosForAddress(t)));return Promise.all(n)},utxoListToTableData(t){const e=[];return t.forEach(((t,s)=>{t.length?t.forEach(((t,i)=>{e.push({id:e.length,address:0===i?this.addressList[s]:"",txid:t.txid,value:t.value,vout:t.vout})})):e.push({id:e.length,address:this.addressList[s]})})),e},txDataToPsbt(t,e){const s=new i.Psbt({network:i.networks[this.network]});return t.inputs.forEach((t=>{s.addInput({hash:t.txid,index:t.vout,witnessUtxo:t.witnessUtxo,value:t.value})})),t.outputs.forEach((t=>{t.address||(t.address=e),s.addOutput(t)})),s},findChangeAddress(){const t=this.utxoList[this.utxoList.length-1];if(t&&t.txid)return"";for(let e=this.utxoList.length-2;e>=0;e--)if(this.utxoList[e]&&this.utxoList[e].txid)return this.utxoList[e+1].address;return""},selectNetwork(t){this.network=t},selectFee(t){this.feeMode=t,this.feeValue=this.fees[this.feeMode]},toggleEmptyAddresses(){this.showEmptyAddresses=!this.showEmptyAddresses,this.tableData=this.showEmptyAddresses?this.utxoList:this.utxoList.filter((t=>t.txid))},deriveAddresses(t,e={}){const s=e.start||0,a=e.size||10,o=e.rootPath||"m/84'/0'/0'/0",n=e.network||i.networks.testnet,r=[];for(let l=s;l<s+a;l++){const e=`${o}/${l}`,s=t.derivePath(e).publicKey,a=i.payments.p2wpkh({pubkey:s,network:n});r.push(a.address)}return r},zpubToXpub(e){let s=b58.decode(e);return s=s.slice(4),s=t.concat([t.from("0488b21e","hex"),s]),b58.encode(s)},showError(t){console.error(t),this.$q.notify({icon:"error",type:"warning",message:t.message||t})},showMesage(t="..."){return this.$q.notify({timeout:0,spinner:!0,message:t})}},async mounted(){this.updateFees()}}}).call(this,s("1c35").Buffer)},6:function(t,e){},7:function(t,e){},"79ad":function(t,e,s){const i=s("bc3a");let a="";async function o(){const t=await i.get(`${a}/api/v1/fees/recommended`);if(200!==t.status)throw new Error(`Cannot fetch fees from ${a}`);return t.data}function n(t){if(!t)throw new Error("Please provide the host value!");return a=t,{getRecommendedFees:o}}t.exports=n},"806b":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",[s("div",{staticClass:"row q-col-gutter-md justify-center"},[s("div",{staticClass:"col-12 col-md-10 col-lg-10 q-gutter-y-md"},[s("h5",{staticClass:"q-pt-lg q-mb-xs"},[t._v("\n        Build PSBT\n      ")]),s("q-card",{staticClass:"q-mt-lg"},[s("q-card-section",[s("q-form",{staticClass:"q-gutter-md",on:{submit:t.findUtxos}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-9"},[s("q-input",{staticClass:"q-pr-md",attrs:{filled:"",dense:"",label:"xpub/zpub"},model:{value:t.xPub,callback:function(e){t.xPub=e},expression:"xPub"}})],1),s("div",{staticClass:"col-3"},[s("q-btn-dropdown",{attrs:{label:t.network}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(){return t.selectNetwork("bitcoin")}}},[s("q-item-section",[s("q-item-label",[t._v("Bitcoin")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(){return t.selectNetwork("testnet")}}},[s("q-item-section",[s("q-item-label",[t._v("Testnet")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(){return t.selectNetwork("regtest")}}},[s("q-item-section",[s("q-item-label",[t._v("Regtest")])],1)],1)],1)],1)],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"},[s("q-input",{attrs:{filled:"",dense:"",label:"derivation root (eg: m/44'/0'/0'/0)"},model:{value:t.derivationRoot,callback:function(e){t.derivationRoot=e},expression:"derivationRoot"}})],1),s("div",{staticClass:"col-1"}),s("div",{staticClass:"col-3"},[s("q-input",{attrs:{filled:"",dense:"",label:"derivation start index"},model:{value:t.derivationStartIndex,callback:function(e){t.derivationStartIndex=e},expression:"derivationStartIndex"}})],1),s("div",{staticClass:"col-1"}),s("div",{staticClass:"col-3"},[s("q-input",{attrs:{filled:"",dense:"",label:"size"},model:{value:t.derivationSize,callback:function(e){t.derivationSize=e},expression:"derivationSize"}})],1),s("div",{staticClass:"col-2"})]),s("q-btn",{attrs:{unelevated:"",color:"primary",disable:""==t.xPub,type:"submit"}},[t._v("Find UTXOs")])],1)],1)],1),s("q-card",{staticClass:"q-mt-lg"},[s("q-card-section",[s("div",{staticClass:"row"},[s("div",{staticClass:"col-6"},[s("h6",{staticClass:"text-subtitle1 q-mt-none q-mb-sm"},[t._v("\n                UTXO List\n              ")])]),s("div",{staticClass:"col-6"},[s("div",{attrs:{align:"right"}},[s("q-btn",{attrs:{unelevated:"",color:"secondary"},on:{click:t.toggleEmptyAddresses}},[t._v(t._s(t.showEmptyAddresses?"Hide":"Show")+" Empty\n                  Addresses")])],1)])])]),s("q-card-section",[s("q-table",{attrs:{data:t.tableData,columns:t.columns,"row-key":"id",pagination:t.pagination,dark:"",color:"amber"}})],1)],1),s("q-card",{staticClass:"q-mt-lg"},[s("q-card-section",[s("q-form",{staticClass:"q-gutter-md",on:{submit:t.buildPsbt}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-9"},[s("q-input",{staticClass:"q-pr-md",attrs:{filled:"",dense:"",label:"destination address"},model:{value:t.destinationAddress,callback:function(e){t.destinationAddress=e},expression:"destinationAddress"}})],1),s("div",{staticClass:"col-3"},[s("q-input",{attrs:{filled:"",dense:"",type:"number",label:"amount (sats)"},model:{value:t.sentAmount,callback:function(e){t.sentAmount=e},expression:"sentAmount"}})],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"col-9"},[s("q-input",{staticClass:"q-pr-md",attrs:{filled:"",dense:"",label:"change address"},model:{value:t.changeAddress,callback:function(e){t.changeAddress=e},expression:"changeAddress"}})],1),s("div",{staticClass:"col-3"},[s("q-btn-dropdown",{attrs:{label:t.feeMode+" ("+t.feeValue+")"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(){return t.selectFee("fastestFee")}}},[s("q-item-section",[s("q-item-label",[t._v("Fastest Fee ("+t._s(t.fees.fastestFee||"")+")")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(){return t.selectFee("halfHourFee")}}},[s("q-item-section",[s("q-item-label",[t._v("Half Hour Fee ("+t._s(t.fees.halfHourFee||"")+")")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(){return t.selectFee("hourFee")}}},[s("q-item-section",[s("q-item-label",[t._v("Hour Fee ("+t._s(t.fees.hourFee||"")+")")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(){return t.selectFee("minimumFee")}}},[s("q-item-section",[s("q-item-label",[t._v("Minimum Fee ("+t._s(t.fees.minimumFee||"")+")")])],1)],1)],1)],1)],1)]),s("q-btn",{attrs:{unelevated:"",color:"primary",type:"submit"}},[t._v("Buld PSBT")]),s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[s("q-input",{staticClass:"q-pr-md",attrs:{filled:"",dense:"",autogrow:"",label:"base64 PSBT"},model:{value:t.base64Psbt,callback:function(e){t.base64Psbt=e},expression:"base64Psbt"}})],1)])],1)],1)],1)],1)])])},a=[],o=s("50b2"),n=o["a"],r=s("2877"),l=s("9989"),c=s("f09f"),d=s("a370"),u=s("0378"),h=s("27f9"),f=s("f20b"),m=s("1c1c"),p=s("66e5"),b=s("4074"),v=s("0170"),w=s("9c40"),x=s("eaac"),g=s("7f67"),q=s("eebe"),k=s.n(q),C=Object(r["a"])(n,i,a,!1,null,null,null);e["default"]=C.exports;k()(C,"components",{QPage:l["a"],QCard:c["a"],QCardSection:d["a"],QForm:u["a"],QInput:h["a"],QBtnDropdown:f["a"],QList:m["a"],QItem:p["a"],QItemSection:b["a"],QItemLabel:v["a"],QBtn:w["a"],QTable:x["a"]}),k()(C,"directives",{ClosePopup:g["a"]})},abf0:function(t,e,s){const i=s("bc3a");let a="";async function o(t){if(!t)throw new Error("Transaction ID is missing!");const e=await i.get(`${a}/api/tx/${t}`);if(200!==e.status)throw new Error(`Cannot fetch Transaction for ID ${t}`);return e.data}async function n(t){if(!t)throw new Error("Transaction ID is missing!");const e=await i.get(`${a}/api/tx/${t}/hex`);if(200!==e.status)throw new Error(`Cannot fetch Transaction for ID ${t}`);return e.data}function r(t){if(!t)throw new Error("Please provide the host value!");return a=t,{getTxHex:n,getTx:o}}t.exports=r}}]);